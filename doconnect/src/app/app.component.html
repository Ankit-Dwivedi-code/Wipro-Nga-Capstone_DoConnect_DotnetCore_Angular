<mat-toolbar color="primary" class="navbar">
  <span routerLink="/questions" style="cursor: pointer;" class="logo">DoConnect</span>

  <span class="spacer"></span>

  <!-- COLLAPSIBLE WRAPPER -->
  <nav class="nav-links" [class.open]="mobileOpen">
    <ng-container *ngIf="auth.isLoggedIn(); else guest">
      
      <button mat-button routerLink="/questions">Questions</button>
      <button mat-button routerLink="/questions/ask">Ask</button>
      
      <!-- Admin-only management buttons -->
      <ng-container *ngIf="auth.getUser()?.role === 'Admin'">
        <button mat-button routerLink="/admin" aria-label="Manage questions and answers">
          Manage Q/A
        </button>
        <button mat-button routerLink="/admin/users" aria-label="Manage users">
          Manage Users
        </button>
      </ng-container>

      <!-- User only -->
      <ng-container *ngIf="auth.getUser()?.role === 'User'">
        <button
          mat-raised-button
          routerLink="/ask-ai"
          class="ask-ai-btn"
          aria-label="Ask AI"
        >
          <mat-icon class="spark">auto_awesome</mat-icon>
          <span>Ask AI</span>
        </button>
      </ng-container>

      <!-- NEW: username dropdown (Profile + Logout) -->
      <button
        mat-button
        class="user-btn"
        [matMenuTriggerFor]="userMenu"
        aria-label="User menu"
      >
        <mat-icon>account_circle</mat-icon>
        <span class="user-name">{{ auth.getUser()?.Username }}</span>
        <mat-icon class="chev">expand_more</mat-icon>
      </button>
      <mat-menu #userMenu="matMenu">
        <button mat-menu-item routerLink="/profile">
          <mat-icon>person</mat-icon>
          <span>Profile</span>
        </button>
        <button mat-menu-item (click)="logout()">
          <mat-icon>logout</mat-icon>
          <span>Logout</span>
        </button>
      </mat-menu>

    
      <!-- <button mat-button (click)="logout()">Logout</button> -->
    </ng-container>

    <ng-template #guest>
      <button mat-button routerLink="/auth/login">Login</button>
      <button mat-button routerLink="/auth/register">Register</button>
    </ng-template>
  </nav>

  <!-- mobile hamburger -->
  <button
    mat-icon-button
    class="hamburger"
    (click)="toggleMobile()"
    aria-label="Toggle navigation"
  >
    <mat-icon>{{ mobileOpen ? 'close' : 'menu' }}</mat-icon>
  </button>
</mat-toolbar>

<div class="container">
  <router-outlet></router-outlet>
</div>
